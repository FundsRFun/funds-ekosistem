{% extends 'main/base.html' %}
{% block title %}Data Tabungan{% endblock %}
{% block content %}
<div class="container-fluid mt-4">
  <div class="card shadow border-0">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h5 class="mb-0"><i class="fas fa-list"></i> Data Tabungan</h5>
      <div class="d-flex gap-2">
        <form method="get" class="d-flex">
          <input type="text" name="q" class="form-control form-control-sm me-2" 
                 placeholder="Cari data..." value="{{ query }}">
          <button class="btn btn-light btn-sm" type="submit"><i class="fas fa-search"></i></button>
        </form>
        <a href="{% url 'upload_tabungan' %}" class="btn btn-light btn-sm">
          <i class="fas fa-upload"></i> Upload Baru
        </a>
      </div>
    </div>

    <div class="card-body table-responsive">
      <table class="table table-hover table-bordered align-middle">
        <thead class="table-dark text-center">
          <tr>
            <th>No</th>
            <th>Nama Cabang</th>
            <th>Nama Uker</th>
            <th>Segmentasi</th>
            <th>Jenis Produk</th>
            <th>Group Product</th>
            <th>Tanggal Posisi</th>
            <th>Flag Posisi</th>
            <th>Nama Region</th>
            <th>Jumlah Rekening</th>
            <th>Saldo</th>
          </tr>
        </thead>
        <tbody>
          {% for t in data %}
          <tr>
            <td class="text-center">{{ forloop.counter0|add:data.start_index }}</td>
            <td>{{ t.nama_cabang }}</td>
            <td>{{ t.nama_uker }}</td>
            <td>{{ t.segmentasi }}</td>
            <td>{{ t.jenis_produk }}</td>
            <td>{{ t.group_product }}</td>
            <td>{{ t.tanggal_posisi }}</td>
            <td>{{ t.flag_posisi }}</td>
            <td>{{ t.nama_region }}</td>
            <td class="text-end">{{ t.jumlah_rekening }}</td>
            <td class="text-end">Rp {{ t.saldo|floatformat:2 }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="11" class="text-center text-muted">Belum ada data tabungan</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {% if data.has_other_pages %}
    <div class="card-footer bg-light border-0 d-flex justify-content-end">
      <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm mb-0">
          {% if data.has_previous %}
            <li class="page-item"><a class="page-link" href="?page=1{% if query %}&q={{ query }}{% endif %}">&laquo; First</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ data.previous_page_number }}{% if query %}&q={{ query }}{% endif %}">Prev</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">&laquo; First</span></li>
            <li class="page-item disabled"><span class="page-link">Prev</span></li>
          {% endif %}

          <li class="page-item active"><span class="page-link">{{ data.number }} / {{ data.paginator.num_pages }}</span></li>

          {% if data.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ data.next_page_number }}{% if query %}&q={{ query }}{% endif %}">Next</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ data.paginator.num_pages }}{% if query %}&q={{ query }}{% endif %}">Last &raquo;</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Next</span></li>
            <li class="page-item disabled"><span class="page-link">Last &raquo;</span></li>
          {% endif %}
        </ul>
      </nav>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
